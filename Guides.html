<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <!-- Preload category emoji images -->
  <link rel="preload" href="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-redfish.png" as="image">
  <link rel="preload" href="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-blue-marlin.png" as="image">
  <link rel="preload" href="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-flounder.png" as="image">
  
  <title>Fishing Gear by Category</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
     body {
      font-family: Arial, sans-serif;
      background: #f0f8ff;
      margin: 0;
      padding: 1rem;
      background-color: transparent;
    }

     .category {
      background: #7CCFCF; /* was #92D6B5 */
      color: #1a237e;
      padding: .5rem;
      margin-bottom: 0.5rem;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .category:hover {
      background-color: rgba(250, 180, 0, 0.5); /* darker aqua */
      color: #003c54; /* deeper blue for contrast */
      transform: translateY(-1px);
    }
.subcategory {
  display: none;
  background: #DCFAF7; /* was #e6fafa */
  padding: 0.5rem 1rem;
  margin-bottom: 0.5rem;
  border-left: 4px solid #3b9c9c;
}

/* collapse on load */
.sub-subcategory {
  display: none;
  margin-left: 1rem;
  padding: 0.25rem .25rem;
  background: rgba(220, 250, 247, 0.80); /* was #DCFAF7 */
  border-left: 4px solid #3b9c9c;
}

.sub-subcategory h4 {
  margin: 0.5rem 0 0.25rem;
  color: #006666;
}

.sub-subcategory ul {
  padding-left: 1rem;
  padding-top: .15rem;
  list-style-type: none;
  margin: 0;
}

.sub-subcategory li {
  margin: 0.25rem 0;
}

.sub-subcategory a {
  color: #003333;
  text-decoration: none;
}

.sub-subcategory a:hover {
  text-decoration: underline;
}

@media (min-width: 600px) {
  body {
    max-width: 600px;
    margin: auto;
  }
}

body {
  background-color: transparent;
}
.emoji {
  height: 36px;
  margin-right: 0.5rem;
  vertical-align: middle;
}
  </style>
</head>
<body>

  <div class="category" onclick="toggle(this)">
    <img class="emoji" src="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-redfish.png" alt="Bay Fishing">Bay Fishing</div>
  <div class="sub-subcategory">
    <ul><li><a href='https://bayfishingportaransastx.com/' target='_blank'>Alex Porter's Fishing Guide Service</a></li></ul>
    <ul><li><a href='https://www.coastalbendkayaking.com/' target='_blank'>Coastal Bend Kayak</a></li></ul>
    <ul><li><a href='https://www.coastalcharterstx.com/' target='_blank'>Coastal Charters TX</a></li></ul>
    <ul><li><a href='https://kenjofly.com/' target='_blank'>Kenjo Fly Fishing Charters</a></li></ul>
    <ul><li><a href='https://www.facebook.com/portabaycharters/' target='_blank'>Port "A" Bay Charters</a></li></ul>
    <ul><li><a href='https://www.portaransasflyfish.com/' target='_blank'>Port Aransas Fly Fishing</a></li></ul>
    <ul><li><a href='https://www.redtagguide.com/' target='_blank'>Red Tag Guide Service</a></li></ul>
    <ul><li><a href='https://www.facebook.com/tejasredfishcharters/' target='_blank'>Tejas Guide Service</a></li></ul>
    <ul><li><a href='https://www.wintonsguideservice.com/' target='_blank'>Winton's Guide Service</a></li></ul>
    <ul><li><a href='https://woodysfishingadventures.com/' target='_blank'>Woody's Fishing Adventures</a></li></ul>
  </div>

  <div class="category" onclick="toggle(this)">
    <img class="emoji" src="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-blue-marlin.png" alt="Deep Sea Fishing">Deep Sea Fishing</div>
  <div class="sub-subcategory">
    <ul><li><a href='https://www.coastalcharterstx.com/' target='_blank'>Coastal Charters TX</a></li></ul>
    <ul><li><a href='http://www.deepseaheadquarters.com/' target='_blank'>Deep Sea Headquarters</a></li></ul>
    <ul><li><a href='https://dolphindocks.com/' target='_blank'>Dolphin Docks</a></li></ul>
    <ul><li><a href='http://fishermanswharfporta.com/' target='_blank'>Fisherman's Wharf</a></li></ul>
  </div>

  <div class="category" onclick="toggle(this)">
    <img class="emoji" src="https://raw.githubusercontent.com/jaime62/hookedonporta-site/main/images/emoji-fish-flounder.png" alt="Flounder Gigging">Flounder Gigging</div>
  <div class="sub-subcategory">
    <ul><li><a href='https://www.nightstalkerguideservice.com/' target='_blank'>Nightstalker Guide Service (Rockport)</a></li></ul>
    <ul><li><a href='https://surrenderatsunrise.com/' target='_blank'>Surrender at Sunrise - Capt. Dave</a></li></ul>
    <ul><li><a href='https://walkersguideservice.com/' target='_blank'>Walker's Guide Service</a></li></ul>
  </div>

<!-- ===== Collapsing + Iframe sizing script (replaces earlier two scripts) ===== -->
<script>
  // ===== IFRAME HEIGHT HELPERS =====
  let resizeTimeout;
  let lastSentHeight = 0;

  function sendHeightToParent() {
    const currentHeight = document.documentElement.scrollHeight;
    if (currentHeight !== lastSentHeight) {
      window.parent.postMessage({ type: 'resize-iframe', height: currentHeight }, '*');
      lastSentHeight = currentHeight;
    }
  }
  function debouncedResize(delay = 150) {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(sendHeightToParent, delay);
  }

  // Observe layout/mutation changes and keep iframe sized
  const resizeObserver = new ResizeObserver(() => debouncedResize(100));
  resizeObserver.observe(document.body);

  const mutationObserver = new MutationObserver(() => debouncedResize(200));
  mutationObserver.observe(document.body, { attributes: true, childList: true, subtree: true });

  // ===== COLLAPSE / EXPAND LOGIC =====

  // Hide all panels of the given selector(s)
  function hideAllPanels() {
    document.querySelectorAll(".subcategory, .sub-subcategory").forEach(el => {
      el.style.display = "none";
    });
  }

  // Given a category element, return the list of its panels:
  // all consecutive siblings until the next .category (or end of document)
  function getPanelsForCategory(categoryEl) {
    const panels = [];
    let n = categoryEl.nextElementSibling;
    while (n && !n.classList.contains("category")) {
      if (n.classList.contains("subcategory") || n.classList.contains("sub-subcategory")) {
        panels.push(n);
      }
      n = n.nextElementSibling;
    }
    return panels;
  }

  // Toggle handler used by onclick="toggle(this)"
  function toggle(element) {
    const panels = getPanelsForCategory(element);
    if (panels.length === 0) return;

    // Determine if the group is currently open (any panel visible)
    const isOpen = panels.some(p => p.style.display === "block");

    // Close everything else first (accordion behavior)
    hideAllPanels();

    // If it was closed, open all panels for this category
    if (!isOpen) {
      panels.forEach(p => p.style.display = "block");
    }

    // Nudge parent iframe
    debouncedResize(100);
    setTimeout(sendHeightToParent, 600);
  }

  // Ensure everything starts collapsed
  document.addEventListener("DOMContentLoaded", () => {
    hideAllPanels();
    // Initial sizing
    setTimeout(sendHeightToParent, 300);
  });

  // Keep sizing responsive
  window.addEventListener('resize', () => debouncedResize(200));
</script>
<!-- ===== End collapsing script ===== -->

<!-- ↓↓↓ open all links in a single centered popup window ↓↓↓ -->
<script>
  // Opens URL in a centered, reusable popup window
  function openCustomPopup(url) {
    const popupWidth = 900;
    const popupHeight = 700;
    const openerWidth = window.innerWidth;
    const openerHeight = window.innerHeight;
    const openerLeft = window.screenX || window.screenLeft || 0;
    const openerTop  = window.screenY || window.screenTop  || 0;
    const left = Math.max(0, openerLeft + (openerWidth  - popupWidth)  / 2);
    const top  = Math.max(0, openerTop  + (openerHeight - popupHeight) / 2);

    // Reuse the same window name so subsequent clicks replace contents
    window.open(
      url,
      "HookedPopup",
      `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable=yes,scrollbars=yes,noopener=yes`
    );
  }

  // Apply popup behavior to (almost) all links on the page
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("a[href]").forEach(link => {
      link.addEventListener("click", function (e) {
        const href = this.getAttribute("href") || "";

        // Let these behave normally:
        const isHash = href.startsWith("#");
        const isJs = href.startsWith("javascript:");
        const isMail = href.startsWith("mailto:");
        const isTel = href.startsWith("tel:");
        const hasDownload = this.hasAttribute("download");
        const noPopup = this.dataset.noPopup !== undefined; // opt-out via data-no-popup

        // Respect user intent: new-tab/middle click or modifier keys
        const isModified = e.defaultPrevented ||
                           e.button === 1 || // middle click
                           e.metaKey || e.ctrlKey || e.shiftKey || e.altKey;

        if (isHash || isJs || isMail || isTel || hasDownload || noPopup || isModified) {
          return; // allow default behavior
        }

        e.preventDefault();
        openCustomPopup(this.href);
      });
    });
  });
</script>
<!-- ↑↑↑ End popup behavior ↑↑↑ -->

</body>
</html>
