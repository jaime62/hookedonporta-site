<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hooked on Port A — Live Webcams</title>
  <meta name="description" content="Live webcams around Port Aransas with one-click viewing.">

  <!-- Speed/preload (optional hints for common hosts) -->
  <link rel="preconnect" href="https://g1.ipcamlive.com" crossorigin>
  <link rel="dns-prefetch" href="https://g1.ipcamlive.com">
  <link rel="preconnect" href="https://www.youtube.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.youtube.com">
  <link rel="preconnect" href="https://player.vimeo.com" crossorigin>
  <link rel="dns-prefetch" href="https://player.vimeo.com">

  <style>
    /* --- HookedOnPortA theme tokens --- */
    .hop-btn { appearance:none; background:#1C5A98; color:#fff; border:none; border-radius:9999px; padding:10px 16px; font-weight:700; letter-spacing:.02em; text-transform:uppercase; line-height:1; box-shadow:0 4px 0 #0e3a66, 0 8px 16px rgba(0,0,0,.15); cursor:pointer; transition: transform .06s ease, box-shadow .15s ease, filter .15s ease, background-color .15s ease; }
    .hop-btn:hover { filter:brightness(1.05); transform: translateY(-1px); box-shadow:0 5px 0 #0e3a66, 0 12px 20px rgba(0,0,0,.18); }
    .hop-btn:active { transform: translateY(2px); box-shadow:0 2px 0 #0e3a66, 0 6px 12px rgba(0,0,0,.18); }

    :root{
      --bg:#f8f8f8; --card:#ffffff; --text:#1f2937; --muted:#6b7280; --border:#e2e8f0; --shadow:0 0 15px rgba(0,0,0,0.1); --radius:12px;
      --primary:#0ea5e9; --accent:#f97316; --gap:18px; --map-radius:16px;
    }
    html, body { padding:0; margin:0; background:var(--bg); color:var(--text); font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"; line-height:1.55; }
    .container{ max-width:850px; margin:60px auto; padding:30px; background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); overflow:visible; }

    .header{ position:relative; margin-bottom:20px; text-align:center; overflow:visible; }
    .logo{ display:block; margin:0 auto; max-height:90px; height:auto; width:auto; max-width:min(520px,92vw); object-fit:contain; padding-inline:8px; }
    .subhead{ color:#F77E17; margin-top:12px; }

    .card{
      border:1px solid var(--border);
      border-radius:var(--map-radius);
      background:#fff;
      overflow:visible;
      color:inherit;
    }
    .card-header{ display:flex; align-items:center; gap:10px; padding:12px 14px; border-bottom:1px solid var(--border); background:#fff; justify-content:center; }
    .card-header label{ font-weight:600; margin-right:4px; }
    .card-body{ position:relative; background:#000; }

    .player-wrap{
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      border-radius: 0;
    }
    .player-wrap iframe,
    .player-wrap > div,
    .player-wrap video{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
      display:block;
      background:#000;
    }

    select{ padding:10px; font-size:16px; border-radius:10px; border:1px solid var(--border); background:#fff; }

    footer{ margin:30px auto 10px; border-top:1px solid var(--border); padding:20px; text-align:center; color:#6b7280; font-size:14px; max-width:1100px; }

    @media (max-width:640px){
      .container{ margin:30px 16px; padding:20px; }
      .logo{ max-height:90px; margin-bottom:10px; }
    }

    #camSelector{
      appearance: none;
      background-color: #1C5A98;
      color: #fff;
      border: 1px solid #0e3a66;
      border-radius: 10px;
      padding: 10px 36px 10px 12px;
      background-image:
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='14' height='10' viewBox='0 0 20 14' fill='none'><path d='M2 2l8 8 8-8' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/></svg>");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 14px;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
      <a href="https://HookedOnPortA.com" target="_parent"
         onclick="window.open(this.href, '_parent'); window.close(); return false;">
        <img class="logo"
             src="https://github.com/jaime62/hookedonporta-site/blob/main/images/TTB-Logo.png?raw=true"
             alt="HookedOnPortA.com">
      </a>
      <h2 class="subhead">Live Webcams</h2>
    </div>

    <section class="card" aria-label="Live webcam player">
      <div class="card-header">
        <label for="camSelector">Camera:</label>
        <div class="controls">
          <select id="camSelector" aria-label="Choose a webcam">
            <option value="aransaspass">Aransas Pass Harbor Park</option>
            <option value="deepsea">Deep Sea Headquarters</option>
            <option value="dolphineast">Dolphin Docks East</option>
            <option value="dolphinwest">Dolphin Docks West</option>
            <option value="gulfwaters">Gulf Waters Beach Front RV Resort</option>
            <option value="shipchannel">Port Aransas Ship Channel</option>
            <option value="utmsieast">UTMSI Pier — Harbor (East)</option>
            <option value="utmsiwest">UTMSI Pier — Harbor (West)</option>
          </select>
        </div>
      </div>

      <div class="card-body">
        <div id="playerWrap" class="player-wrap"></div>
      </div>
    </section>
  </div>

  <div style="text-align:center; margin-top:50px;">
    <button class="hop-btn" onclick="window.close()">Close</button>
  </div>

  <footer>
    <div>2025 Tech Tackle Box™</div>
  </footer>

  <!-- hls.js for live streams -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

  <!-- YouTube API (only needed for Aransas Pass) -->
  <script>
    let ytApiReadyPromise;
    function ensureYTAPI(){
      if (ytApiReadyPromise) return ytApiReadyPromise;
      ytApiReadyPromise = new Promise((resolve) => {
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        window.onYouTubeIframeAPIReady = () => resolve();
        document.head.appendChild(tag);
      });
      return ytApiReadyPromise;
    }
  </script>

  <script>
    const cams = {
      deepsea: {
        html: `<iframe src="https://g1.ipcamlive.com/player/player.php?alias=portafishrack&autoplay=1&mute=1"
                     allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`
      },
      dolphineast: {
        html: `<iframe src="https://g1.ipcamlive.com/player/player.php?alias=dolphindockeast&autoplay=1&mute=1"
                     allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`
      },
      dolphinwest: {
        html: `<iframe src="https://g1.ipcamlive.com/player/player.php?alias=dolphindockwest&autoplay=1&mute=1"
                     allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`
      },
      gulfwaters: {
        html: `<iframe src="https://www.youtube.com/embed/Ue6-LTCBCDY?autoplay=1&mute=1&playsinline=1&rel=0"
                     allow="autoplay; encrypted-media; picture-in-picture; fullscreen" allowfullscreen></iframe>`
      },
      shipchannel: {
        html: `<iframe src="https://g1.ipcamlive.com/player/player.php?alias=farley&autoplay=1"
                     allowfullscreen></iframe>`
      },
      aransaspass: { ytId: "Mn3vY8bordE" },

      /* UTMSI cameras (HLS streams) */
      utmsiwest: {
        hls: "https://stage-ams-nfs.srv.axds.co/stream/adaptive/gcoos/utmsi_west/hls.m3u8"
      },
      utmsieast: {
        /* If their slug differs, adjust just the path segment below. */
        hls: "https://stage-ams-nfs.srv.axds.co/stream/adaptive/gcoos/utmsi_east/hls.m3u8"
      }
    };

    const sel = document.getElementById('camSelector');
    const playerWrap = document.getElementById('playerWrap');
    let ytPlayer = null;
    let hlsInstance = null;
    let currentVideoEl = null;

    function teardownPlayers(){
      if (ytPlayer && ytPlayer.destroy) { try { ytPlayer.destroy(); } catch(e){} ytPlayer = null; }
      if (hlsInstance) { try { hlsInstance.destroy(); } catch(e){} hlsInstance = null; }
      if (currentVideoEl && currentVideoEl.parentNode){
        try { currentVideoEl.pause(); } catch(e){}
        currentVideoEl.parentNode.removeChild(currentVideoEl);
        currentVideoEl = null;
      }
    }

    function mountYouTube(videoId){
      playerWrap.innerHTML = `<div id="ytPlayer"></div>`;
      ensureYTAPI().then(() => {
        if (ytPlayer && ytPlayer.destroy) { try { ytPlayer.destroy(); } catch(e){} }
        ytPlayer = new YT.Player('ytPlayer', {
          videoId,
          playerVars: { autoplay:1, mute:1, playsinline:1, rel:0, modestbranding:1, controls:1 },
          events: { onReady: e => { try{e.target.mute(); e.target.playVideo();}catch(e){} } }
        });
      });
    }

    function mountHLS(hlsUrl){
      playerWrap.innerHTML = "";
      const video = document.createElement('video');
      video.setAttribute('playsinline','');
      video.setAttribute('muted','');
      video.muted = true;
      video.autoplay = true;
      video.controls = true;
      playerWrap.appendChild(video);
      currentVideoEl = video;

      if (video.canPlayType('application/vnd.apple.mpegURL')) {
        video.src = hlsUrl;
        video.play().catch(()=>{});
      } else if (window.Hls && window.Hls.isSupported()){
        hlsInstance = new Hls({
          capLevelToPlayerSize: true,
          maxLoadingDelay: 2,
          liveBackBufferLength: 18
        });
        hlsInstance.loadSource(hlsUrl);
        hlsInstance.attachMedia(video);
        hlsInstance.on(Hls.Events.MEDIA_ATTACHED, () => { video.play().catch(()=>{}); });
        hlsInstance.on(Hls.Events.ERROR, (_, data) => {
          if (data.fatal) {
            switch (data.type) {
              case Hls.ErrorTypes.NETWORK_ERROR: hlsInstance.startLoad(); break;
              case Hls.ErrorTypes.MEDIA_ERROR:   hlsInstance.recoverMediaError(); break;
              default:                           hlsInstance.destroy(); break;
            }
          }
        });
      } else {
        playerWrap.innerHTML = `<div style="display:grid;place-items:center;height:100%;color:#fff;text-align:center;padding:12px">
          <p>Live stream requires an updated browser.<br>
          <a href="${hlsUrl}" target="_blank" rel="noopener" style="color:#0ea5e9">Open stream</a></p>
        </div>`;
      }
    }

    function loadCam(key){
      const cam = cams[key];
      if(!cam) return;
      teardownPlayers();
      if (cam.html){ playerWrap.innerHTML = cam.html; }
      else if (cam.ytId){ mountYouTube(cam.ytId); }
      else if (cam.hls){ mountHLS(cam.hls); }
    }

    sel.value = 'deepsea';
    loadCam(sel.value);
    sel.addEventListener('change', e => loadCam(e.target.value));
  </script>
</body>
</html>
